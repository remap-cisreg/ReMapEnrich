---
title: "Roken: graphic functions"
author: "Martin Mestdagh, Zacharie Ménétrier"
date: "`r Sys.Date()`"
package: "`r pkg_ver('roken')`"
vignette: >
    %\VignetteIndexEntry{roken-graphic-functions}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
output: 
    BiocStyle::html_document
bibliography: 
    bibliography.bib
csl:
    biomed-central.csl
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>", eval=FALSE)
options(tibble.print_min = 4L, tibble.print_max = 4L)
library(dplyr)
```

# Abstract

This vignette will presents graphical representations of enrichment analysis that are implemented in this package.

# Bar plot

First we must load an enrichment example data set in order to display it.

```{r}
library(roken)
# Load an enrichment example.
data("enrichment_example", package = "roken")
```

We can now display a bar plot which is the most basic representation of an enrichment analysis.

```{r}
# Display a bar plot
EnrichmentBarPlot(enrichmentExample, sigDisplayQuantile = 0.5, top = 20, aRisk = 0.00001)
```

The displayed plot represents the most significant categories and their q-significances. The sigDisplayQuantile parameter allow to choose a quatile limit at which the bars will stop expanding. The values of those bars will be displayed on it.
The top parameter allow to choose how many categories you want to be displayed on the plot, and the aRisk represents the alpha risk that will be rescaled as the significance in order to see which categories reject the null hypothesis.

# Volcano plot

A volcano plot is a type of scatter-plot that is used to quickly identify changes in large data sets composed of replicate data. It plots significance versus fold-change on the y and x axes, respectively. As effect size in enrichment analysis is rarely negative you must expect the volcano plot to only expand in one direction.

```{r}
# Display a volcano plot (na.omit() is mandatory as there is NAs in the enrichment data frame).
EnrichmentVolcanoPlot(na.omit(enrichmentExample), sigDisplayQuantile = 0.9, aRisk = 0.00001)
```

# Dot plot

The enrichment dot plot is a good way to compare various informations in the enrichment analysis. It gives hints about the number of overlaps, the mapped peaks ratio and the q-significance for the given number of categories.

```{r}
# Display a dot plot.
EnrichmentDotPlot(enrichmentExample)
```

It should be interesting here to avoid representation of the SOX2 category as it enriched against itself.

```{r}
# Display a dot plot without SOX2.
EnrichmentDotPlot(enrichmentExample[enrichmentExample$category != "SOX2",])
```
